import{r as n,a as c,j as t,e as B}from"./app-0be92e3a.js";import{s as F}from"./pre-employment-file-service-bc6366cc.js";import{h as N}from"./moment-a9aaa855.js";import{g as O}from"./final-rate-thunk-fb57029d.js";import{F as q}from"./FileJpgOutlined-4bae6199.js";import{M as R}from"./index-c2778a57.js";import{U as I}from"./index-7100f061.js";import{m as i}from"./index-387ca5eb.js";import{B as L}from"./button-f1128c2c.js";import{U as C}from"./UploadOutlined-798eadf7.js";import"./applicant-final-service-a1d04fab.js";import"./applicant-record-service-447eda6b.js";import"./presets-ca362eb1.js";import"./defineProperty-83f36300.js";import"./toPropertyKey-d8419463.js";import"./typeof-7fd5df1e.js";import"./AntdIcon-c5433829.js";import"./genStyleUtils-e530599a.js";import"./createSuper-c7e84a61.js";import"./useZIndex-db80d7ed.js";import"./UnstableContext-08b50167.js";import"./regeneratorRuntime-92fa3873.js";import"./asyncToGenerator-8c72b493.js";import"./CheckCircleFilled-ed7a4e86.js";import"./CloseCircleFilled-0112c629.js";import"./InfoCircleFilled-ce80b633.js";import"./useId-75283469.js";import"./CloseOutlined-1f5153c1.js";import"./index-6c3a8b66.js";import"./KeyCode-c6e7b720.js";import"./pickAttrs-436fe4ce.js";import"./fade-441c582f.js";import"./ContextIsolator-47888219.js";import"./useSize-a0c6ad97.js";import"./Compact-cc62eab7.js";import"./useClosable-ad80856e.js";import"./Skeleton-4e8bad90.js";import"./omit-644b1847.js";import"./useLocale-9ab66dca.js";import"./PurePanel-f7234f31.js";import"./Dragger-cc58c530.js";import"./collapse-97de76d4.js";import"./useForceUpdate-7cfcdc76.js";import"./DeleteOutlined-f40801de.js";import"./EyeOutlined-53e02882.js";import"./CheckOutlined-b94dbe7f.js";import"./index-a6c1a90f.js";import"./index-61f18b0c.js";const l=50,V=l*1024*1024,u=a=>{if(!a)return{isValid:!1,error:"No file provided"};const r=(a.size/(1024*1024)).toFixed(2);return a.size>V?{isValid:!1,error:`File size (${r}MB) exceeds the maximum allowed size of ${l}MB`,sizeMB:r}:{isValid:!0,sizeMB:r}};function qe(){var j;const[a,r]=n.useState(!1),[f,h]=n.useState("");c(e=>e.app);const{checklists:w}=c(e=>e.checklists),[s,x]=n.useState([]),[k,g]=n.useState(!1),b=window.location.pathname.split("/")[2],{applicant:p}=c(e=>e.final_rate),d=decodeURIComponent(window.location.pathname.split("/")[3].replace(/\+/g," "));window.location.pathname.split("/")[4];const U=()=>{r(!0)},E=((j=p==null?void 0:p.requirements)==null?void 0:j.map(e=>e.reqs))??[],M=w.filter(e=>!E.includes(e.reqs));console.log("filteredEntries",M);const v=async()=>{if(!s[0]||!s[0].originFileObj){i.error("Please select a file to upload");return}const e=u(s[0].originFileObj);if(!e.isValid){i.error(e.error);return}g(!0);const o=new FormData;o.append("file",s[0].originFileObj),o.append("status","Uploaded"),o.append("reqs",f),o.append("created",N().format("YYYY-MM-DD HH:mm:ss")),o.append("app_id",b);try{s[0].status=="done"&&(await F(o),await B.dispatch(O(b)),i.success("Uploaded successfully!"),r(!1),x([]),h(""),setOpen(!1))}catch(m){if(console.error("Upload error:",m),m.response){const{status:y,data:_}=m.response;y===413?i.error("File size is too large. Maximum allowed size is 50MB."):y===422?i.error(_.message||"Validation failed. Please check your file and try again."):i.error(_.error||"Upload failed. Please try again.")}else i.error("Upload failed. Please check your internet connection and try again.")}finally{g(!1)}},S=()=>{r(!1)};async function z({file:e}){const o=u(e);return o.isValid?(i.info(`File size: ${o.sizeMB}MB (Max: ${l}MB)`),x([e]),!0):(i.error(o.error),!1)}return t.jsxs("div",{children:[t.jsx("div",{className:"flex mt-2.5",children:t.jsxs("button",{type:"button",id:"theme-toggle",onClick:U,className:"px-4 py-2 rounded bg-blue-500 text-white hover:bg-blue-600 focus:outline-none transition-colors",children:[t.jsx(q,{})," UPLOAD REQUIREMENTS"]})}),t.jsxs(R,{confirmLoading:k,title:"UPLOAD REQUIREMENTS",open:a,onOk:v,okText:"Submit",onCancel:S,children:[t.jsxs("div",{className:"w-full",children:[t.jsx("label",{className:"block uppercase tracking-wide  text-xs font-bold mb-1 mt-2",for:"grid-text",children:"Name of Requirements"}),t.jsxs("select",{className:"appearance-none block w-full border border-gray-400 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white focus:border-gray-500",name:"",id:"",onChange:e=>h(e.target.value),children:[!f&&t.jsx("option",{value:"",selected:!0,disabled:!0}),M.filter(e=>!d||(e==null?void 0:e.site)===d).map((e,o)=>t.jsxs("option",{value:e.reqs,children:[e.reqs," ",d?"":` (${e.site})`," ",e.remarks==="Yes"?"*":""]},o))]})]}),t.jsx(I,{action:"https://660d2bd96ddfa2943b33731c.mockapi.io/api/upload",listType:"picture",method:"GET",maxCount:1,onChange:z,multiple:!1,fileList:s,beforeUpload:e=>{const o=u(e);return o.isValid?!0:(i.error(o.error),!1)},children:t.jsx(L,{type:"primary",icon:t.jsx(C,{}),children:"Upload Scanned Image"})}),t.jsxs("div",{className:"mt-3 text-zinc-400 text-sm",children:[t.jsx("p",{children:t.jsx("i",{children:"Note: Requirements marked with an asterisk (*) are mandatory and must be submitted or uploaded to proceed to the next step of the application process."})}),t.jsx("p",{className:"mt-1",children:t.jsxs("i",{children:["Maximum file size: ",l,"MB"]})})]})]})]})}export{qe as default};
