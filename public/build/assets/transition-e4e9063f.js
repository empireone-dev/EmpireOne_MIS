import{r as n,U as f}from"./app-fece3207.js";import{n as S,M as ve,W as B,y as q,O as P,l as J,o as E,x as fe,m as he,c as me,R as pe,i as F,d as be,H as ee,a as re,s as ge,p as Te,u as ne}from"./use-server-handoff-complete-8d4c4d3c.js";function Ce(){let e=n.useRef(!1);return S(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function te(e){var r;return!!(e.enter||e.enterFrom||e.enterTo||e.leave||e.leaveFrom||e.leaveTo)||((r=e.as)!=null?r:ie)!==n.Fragment||f.Children.count(e.children)===1}let A=n.createContext(null);A.displayName="TransitionContext";var Ee=(e=>(e.Visible="visible",e.Hidden="hidden",e))(Ee||{});function we(){let e=n.useContext(A);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}function Re(){let e=n.useContext(j);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}let j=n.createContext(null);j.displayName="NestingContext";function I(e){return"children"in e?I(e.children):e.current.filter(({el:r})=>r.current!==null).filter(({state:r})=>r==="visible").length>0}function le(e,r){let l=ge(e),a=n.useRef([]),w=Ce(),x=Te(),h=E((u,t=P.Hidden)=>{let s=a.current.findIndex(({el:i})=>i===u);s!==-1&&(ne(t,{[P.Unmount](){a.current.splice(s,1)},[P.Hidden](){a.current[s].state="hidden"}}),x.microTask(()=>{var i;!I(a)&&w.current&&((i=l.current)==null||i.call(l))}))}),R=E(u=>{let t=a.current.find(({el:s})=>s===u);return t?t.state!=="visible"&&(t.state="visible"):a.current.push({el:u,state:"visible"}),()=>h(u,P.Unmount)}),b=n.useRef([]),v=n.useRef(Promise.resolve()),m=n.useRef({enter:[],leave:[]}),g=E((u,t,s)=>{b.current.splice(0),r&&(r.chains.current[t]=r.chains.current[t].filter(([i])=>i!==u)),r==null||r.chains.current[t].push([u,new Promise(i=>{b.current.push(i)})]),r==null||r.chains.current[t].push([u,new Promise(i=>{Promise.all(m.current[t].map(([$,y])=>y)).then(()=>i())})]),t==="enter"?v.current=v.current.then(()=>r==null?void 0:r.wait.current).then(()=>s(t)):s(t)}),T=E((u,t,s)=>{Promise.all(m.current[t].splice(0).map(([i,$])=>$)).then(()=>{var i;(i=b.current.shift())==null||i()}).then(()=>s(t))});return n.useMemo(()=>({children:a,register:R,unregister:h,onStart:g,onStop:T,wait:v,chains:m}),[R,h,a,g,T,m,v])}let ie=n.Fragment,ue=ve.RenderStrategy;function $e(e,r){var l,a;let{transition:w=!0,beforeEnter:x,afterEnter:h,beforeLeave:R,afterLeave:b,enter:v,enterFrom:m,enterTo:g,entered:T,leave:u,leaveFrom:t,leaveTo:s,...i}=e,[$,y]=n.useState(null),o=n.useRef(null),d=te(e),ae=q(...d?[o,r,y]:r===null?[]:[r]),D=(l=i.unmount)==null||l?P.Unmount:P.Hidden,{show:p,appear:G,initial:K}=we(),[C,X]=n.useState(p?"visible":"hidden"),Q=Re(),{register:O,unregister:M}=Q;S(()=>O(o),[O,o]),S(()=>{if(D===P.Hidden&&o.current){if(p&&C!=="visible"){X("visible");return}return ne(C,{hidden:()=>M(o),visible:()=>O(o)})}},[C,o,O,M,p,D]);let W=J();S(()=>{if(d&&W&&C==="visible"&&o.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[o,C,W,d]);let oe=K&&!G,V=G&&p&&K,_=n.useRef(!1),N=le(()=>{_.current||(X("hidden"),M(o))},Q),Y=E(k=>{_.current=!0;let U=k?"enter":"leave";N.onStart(o,U,L=>{L==="enter"?x==null||x():L==="leave"&&(R==null||R())})}),Z=E(k=>{let U=k?"enter":"leave";_.current=!1,N.onStop(o,U,L=>{L==="enter"?h==null||h():L==="leave"&&(b==null||b())}),U==="leave"&&!I(N)&&(X("hidden"),M(o))});n.useEffect(()=>{d&&w||(Y(p),Z(p))},[p,d,w]);let ce=(()=>!(!w||!d||!W||oe))(),[,c]=fe(ce,$,p,{start:Y,end:Z}),de=he({ref:ae,className:((a=me(i.className,V&&v,V&&m,c.enter&&v,c.enter&&c.closed&&m,c.enter&&!c.closed&&g,c.leave&&u,c.leave&&!c.closed&&t,c.leave&&c.closed&&s,!c.transition&&p&&T))==null?void 0:a.trim())||void 0,...pe(c)}),H=0;return C==="visible"&&(H|=F.Open),C==="hidden"&&(H|=F.Closed),c.enter&&(H|=F.Opening),c.leave&&(H|=F.Closing),f.createElement(j.Provider,{value:N},f.createElement(be,{value:H},ee({ourProps:de,theirProps:i,defaultTag:ie,features:ue,visible:C==="visible",name:"Transition.Child"})))}function Pe(e,r){let{show:l,appear:a=!1,unmount:w=!0,...x}=e,h=n.useRef(null),R=te(e),b=q(...R?[h,r]:r===null?[]:[r]);J();let v=re();if(l===void 0&&v!==null&&(l=(v&F.Open)===F.Open),l===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[m,g]=n.useState(l?"visible":"hidden"),T=le(()=>{l||g("hidden")}),[u,t]=n.useState(!0),s=n.useRef([l]);S(()=>{u!==!1&&s.current[s.current.length-1]!==l&&(s.current.push(l),t(!1))},[s,l]);let i=n.useMemo(()=>({show:l,appear:a,initial:u}),[l,a,u]);S(()=>{l?g("visible"):!I(T)&&h.current!==null&&g("hidden")},[l,T]);let $={unmount:w},y=E(()=>{var d;u&&t(!1),(d=e.beforeEnter)==null||d.call(e)}),o=E(()=>{var d;u&&t(!1),(d=e.beforeLeave)==null||d.call(e)});return f.createElement(j.Provider,{value:T},f.createElement(A.Provider,{value:i},ee({ourProps:{...$,as:n.Fragment,children:f.createElement(se,{ref:b,...$,...x,beforeEnter:y,beforeLeave:o})},theirProps:{},defaultTag:n.Fragment,features:ue,visible:m==="visible",name:"Transition"})))}function xe(e,r){let l=n.useContext(A)!==null,a=re()!==null;return f.createElement(f.Fragment,null,!l&&a?f.createElement(z,{ref:r,...e}):f.createElement(se,{ref:r,...e}))}let z=B(Pe),se=B($e),Fe=B(xe),He=Object.assign(z,{Child:Fe,Root:z});export{Fe as L,He as X,Ce as f};
