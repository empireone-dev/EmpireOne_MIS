import{r as m,j as e}from"./store-a55f681c.js";import{H as J}from"./main-453c846d.js";import A from"./erf-dropdown-filter-components-9a0160ef.js";import{u as N,a as F}from"./app-2b4e2525.js";import L from"./add-position-button-section-0f76e0da.js";import{s as g}from"./erf-record-slice-4a707e06.js";import H from"./erf-menu-button-section-53914c1a.js";import{T as O}from"./Table-d12b8ff7.js";import{M as U}from"./index-39b97e3b.js";import{C as p}from"./index-d7fd2578.js";import{D as a}from"./index-5d516297.js";import{T as C}from"./index-75080953.js";import{S as V}from"./index-ca3379b2.js";import{B as u}from"./button-f23c5a7b.js";import{I as Q}from"./index-5d4d2f3a.js";import{S as W}from"./index-4ae197e5.js";import{S as $}from"./Input-c0d2b7b2.js";import"./index-289f006b.js";import"./RightOutlined-fb985d1f.js";import"./warning-53117f39.js";import"./defineProperty-83f36300.js";import"./toPropertyKey-d8419463.js";import"./typeof-7fd5df1e.js";import"./AntdIcon-d7012edb.js";import"./shadow-0179b362.js";import"./Dropdown-92e6b838.js";import"./index-62928ae1.js";import"./useId-ed43986a.js";import"./index-bcc69c18.js";import"./createSuper-f29e89b0.js";import"./genStyleUtils-a7424da4.js";import"./useSize-aaf01847.js";import"./Compact-5e8d7c79.js";import"./KeyCode-99629795.js";import"./omit-644b1847.js";import"./useZIndex-fb3092c3.js";import"./index-192bbe31.js";import"./ContextIsolator-04fb1ac5.js";import"./regeneratorRuntime-92fa3873.js";import"./asyncToGenerator-8c72b493.js";import"./PurePanel-419731ae.js";import"./index-55637c6f.js";import"./index-39534d23.js";import"./collapse-97de76d4.js";import"./UnstableContext-6fcf76c5.js";import"./add-new-position-section-e9ed9bd4.js";import"./SnippetsOutlined-73cccf01.js";import"./add-existing-position-section-df9815d0.js";import"./CopyOutlined-b672b236.js";import"./erf-ja-component-7591373c.js";import"./erf-jd-component-c4a85826.js";import"./DownOutlined-006f7871.js";import"./FileOutlined-860abef4.js";import"./FileTextOutlined-aa087039.js";import"./styleChecker-ff91b116.js";import"./pickAttrs-36913342.js";import"./addEventListener-97b21919.js";import"./useLocale-5a99632b.js";import"./useBreakpoint-5c91a51b.js";import"./useForceUpdate-71bd788c.js";import"./responsiveObserver-dd35f1bc.js";import"./useVariants-9bb9b3df.js";import"./CheckOutlined-91571c5b.js";import"./CloseCircleFilled-c59cb59e.js";import"./CloseOutlined-adb2771a.js";import"./index-fc2b2ac7.js";import"./FolderOpenOutlined-564636b4.js";import"./HolderOutlined-bb221e0e.js";import"./CheckCircleFilled-aa27478c.js";import"./InfoCircleFilled-de35a45c.js";import"./index-f7c74257.js";import"./index-349f8d3e.js";import"./fade-52843f21.js";import"./useClosable-68ab5813.js";import"./Skeleton-aa5eb76b.js";import"./index-60447dc8.js";import"./PlusOutlined-86f0d02c.js";import"./progress-80920643.js";import"./EyeOutlined-fe58294a.js";function yt(){var I,R;const[T,x]=m.useState(""),[k,b]=m.useState(""),[_,y]=m.useState(!1),[i,S]=m.useState(null),{erf_records:h,filteredData:E}=N(s=>s.erf_records),{user:c}=N(s=>s.app),j=F();console.log("erf_records",h);const q=s=>{const t=h.filter(o=>{var l;return((l=o.user)==null?void 0:l.id)===(c==null?void 0:c.id)});if(s.length===0)j(g(t));else{const o=t.filter(l=>s.includes(l.status));j(g(o))}};m.useEffect(()=>{const s=h.filter(t=>{var o;return((o=t.user)==null?void 0:o.id)===(c==null?void 0:c.id)});j(g(s))},[h,c]);const M=s=>{S(s),y(!0)},P=()=>{y(!1),S(null)},D=s=>{const t=new Date().toLocaleString(),o=(i==null?void 0:i.submitted)||t,l=[{title:"Submitted",status:"finish",description:"Request submitted by manager"},{title:"In Review",status:"process",description:"Under review by Site Director/Site Manager"},{title:"Approved",status:"finish",description:"Request approved for posting"}];switch(s){case"Pending":return{current:0,steps:l.map((r,n)=>({...r,status:n===0?"process":"wait",title:n===0?`${r.title} (${o})`:r.title,description:r.description}))};case"In Review":return{current:1,steps:l.map((r,n)=>({...r,status:n<1?"finish":n===1?"process":"wait",title:n===0?`${r.title} (${o})`:n===1?`${r.title} (${t})`:r.title,description:r.description}))};case"Approved":return{current:2,steps:l.map((r,n)=>({...r,status:n<2?"finish":n===2?"process":"wait",title:n===0?`${r.title} (${o})`:n===1?`${r.title} (${t})`:n===2?`${r.title} (${t})`:r.title,description:r.description}))};case"Completed":return{current:3,steps:l.map((r,n)=>({...r,status:"finish",title:n===0?`${r.title} (${o})`:`${r.title} (${t})`,description:r.description}))};case"Declined":return{current:1,steps:l.map((r,n)=>({...r,status:n===0?"finish":n===1?"error":"wait",title:n===0?`${r.title} (${o})`:n===1?`Declined (${t})`:r.title,description:n===1?"Request declined by approver":r.description}))};default:return{current:0,steps:l}}},v=m.useRef(null),w=(s,t,o)=>{t(),x(s[0]),b(o)},z=s=>{s(),x("")},d=s=>({filterDropdown:({setSelectedKeys:t,selectedKeys:o,confirm:l,clearFilters:r,close:n})=>e.jsxs("div",{style:{padding:8},onKeyDown:f=>f.stopPropagation(),children:[e.jsx(Q,{ref:v,placeholder:`Search ${s}`,value:o[0],onChange:f=>t(f.target.value?[f.target.value]:[]),onPressEnter:()=>w(o,l,s),style:{marginBottom:8,display:"block"}}),e.jsxs(W,{children:[e.jsx(u,{type:"primary",onClick:()=>w(o,l,s),icon:e.jsx($,{}),size:"small",style:{width:90},children:"Search"}),e.jsx(u,{onClick:()=>r&&z(r),size:"small",style:{width:90},children:"Reset"}),e.jsx(u,{type:"link",size:"small",onClick:()=>{l({closeDropdown:!1}),x(o[0]),b(s)},children:"Filter"}),e.jsx(u,{type:"link",size:"small",onClick:()=>{n()},children:"close"})]})]}),filterIcon:t=>e.jsx($,{style:{color:t?"#1677ff":void 0}}),onFilter:(t,o)=>o[s].toString().toLowerCase().includes(t.toLowerCase()),onFilterDropdownOpenChange:t=>{t&&setTimeout(()=>{var o;return(o=v.current)==null?void 0:o.select()},100)},render:t=>k===s?e.jsx(J,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[T],autoEscape:!0,textToHighlight:t?t.toString():""}):t}),B=[{title:"Ref #",dataIndex:"ref_id",key:"ref_id",render:(s,t)=>e.jsx(u,{type:"link",onClick:()=>M(t),style:{padding:0,height:"auto"},children:e.jsx("u",{children:s})})},{title:"Requesting Manager",dataIndex:"fullname",key:"fullname",...d("fullname"),render:(s,t,o)=>{var l,r;return console.log("record",t),e.jsxs("div",{children:[(l=t.user)==null?void 0:l.employee_fname," ",(r=t.user)==null?void 0:r.employee_lname]},o)}},{title:"Job Title",dataIndex:"jobTitle",key:"position",...d("position")},{title:"Job Type",dataIndex:"jobType",key:"dept",...d("dept")},{title:"Position Status",dataIndex:"positionStatus",key:"eogs",...d("eogs")},{title:"Target Onboarding Date",dataIndex:"dateNeed",key:"contact",...d("contact"),render:s=>s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):""},{title:"Budget/Cost",dataIndex:"budgetCost",key:"eogs",...d("eogs")},{title:"Date Submitted",dataIndex:"submitted",key:"eogs",...d("eogs"),render:s=>s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):""},{title:"Status",dataIndex:"status",key:"status",render:(s,t,o)=>(console.log("record",t),e.jsx(C,{color:t.status=="Approved"?"green":t.status=="Pending"?"orange":t.status=="Declined"?"red":(t.status=="In Review","blue"),children:t.status},o))},{title:"Action",dataIndex:"action",render:(s,t)=>e.jsx(H,{data:t})}];return e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-x-3",children:e.jsx("h2",{className:"text-lg font-medium text-gray-800",children:e.jsx("b",{children:"My ERF Records"})})}),e.jsxs("div",{className:"flex flex-1 justify-between",children:[e.jsx(L,{}),e.jsx("div",{className:"mr-8",children:e.jsx(A,{filterData:q})})]})]}),e.jsx(O,{columns:B,dataSource:E,className:"mt-1"}),e.jsx(U,{title:`ERF Details - ${(i==null?void 0:i.ref_id)||""}`,open:_,onCancel:P,footer:null,width:1e3,style:{top:20},children:i&&e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(p,{title:"Request Information",className:"mb-4",children:e.jsxs(a,{column:2,bordered:!0,size:"small",children:[e.jsx(a.Item,{label:"Reference ID:",children:e.jsx("b",{children:i.ref_id})}),e.jsx(a.Item,{label:"Status:",children:e.jsx(C,{color:i.status==="Approved"?"green":i.status==="Pending"?"orange":i.status==="Declined"?"red":(i.status==="In Review","blue"),children:i.status})}),e.jsx(a.Item,{label:"Requesting Manager:",children:e.jsxs("b",{children:[(I=i.user)==null?void 0:I.employee_fname," ",(R=i.user)==null?void 0:R.employee_lname]})}),e.jsx(a.Item,{label:"Date Submitted:",children:e.jsx("b",{children:i.submitted})}),e.jsx(a.Item,{label:"Job Title:",children:e.jsx("b",{children:i.jobTitle})}),e.jsx(a.Item,{label:"Job Type:",children:e.jsx("b",{children:i.jobType})}),e.jsx(a.Item,{label:"Position Status:",children:e.jsx("b",{children:i.positionStatus})}),e.jsx(a.Item,{label:"Date Needed:",children:e.jsx("b",{children:i.dateNeed})}),e.jsx(a.Item,{label:"Budget/Cost:",span:2,children:e.jsx("b",{children:i.budgetCost})}),i.status==="Declined"&&e.jsx(a.Item,{label:"Reason for Decline:",children:e.jsx("b",{children:i.reason})})]})}),i.businessJustification&&e.jsx(p,{title:"Business Justification",className:"mb-4",children:e.jsx("p",{children:i.businessJustification})}),i.qualifications&&e.jsx(p,{title:"Required Qualifications",className:"mb-4",children:e.jsx("p",{children:i.qualifications})}),i.responsibilities&&e.jsx(p,{title:"Key Responsibilities",children:e.jsx("p",{children:i.responsibilities})})]}),e.jsxs("div",{className:"w-80",children:[e.jsx(p,{title:"Request Progress",size:"small",children:e.jsx(V,{direction:"vertical",current:D(i.status).current,items:D(i.status).steps,size:"small"})}),e.jsx(p,{title:"Timeline Summary",size:"small",className:"mt-4",children:e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Requisition created:"}),e.jsx("span",{className:"text-gray-600",children:i.submitted})]}),i.status!=="Pending"&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Status updated:"}),e.jsx("span",{className:"text-gray-600",children:new Date().toLocaleDateString()})]}),i.dateNeed&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Target start date:"}),e.jsx("span",{className:"text-gray-600",children:i.dateNeed})]})]})})]})]})})]})}export{yt as default};
