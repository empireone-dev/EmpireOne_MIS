import{r as m,m as j,j as e}from"./store-9c50da1b.js";import{H as z}from"./main-aabf4eda.js";import B from"./erf-dropdown-filter-components-a3f04bbb.js";import{u as J,a as A}from"./app-d3aeba3e.js";import F from"./add-position-button-section-33af5e3c.js";import L from"./erf-menu-button-section-7a85afb0.js";import{T as H}from"./Table-7e85b6fb.js";import{M as O}from"./index-da2b390b.js";import{C as d}from"./index-26b5a6e3.js";import{D as l}from"./index-2b956ee0.js";import{T as N}from"./index-cfad3261.js";import{S as U}from"./index-1f52a108.js";import{B as u}from"./button-b7787aae.js";import{I as V}from"./index-9515e1de.js";import{S as Q}from"./index-fd1f9313.js";import{S as R}from"./Input-c898bca9.js";import"./index-badd4cd5.js";import"./RightOutlined-a5c2c03b.js";import"./warning-8a11f3af.js";import"./defineProperty-83f36300.js";import"./toPropertyKey-d8419463.js";import"./typeof-7fd5df1e.js";import"./AntdIcon-936c2873.js";import"./shadow-371a5539.js";import"./Dropdown-b6d52c25.js";import"./index-95bf30d1.js";import"./useId-90ed87ad.js";import"./index-6bfa84b1.js";import"./createSuper-f29e89b0.js";import"./genStyleUtils-00917081.js";import"./useSize-0508f9de.js";import"./Compact-901f24f2.js";import"./KeyCode-548a7212.js";import"./omit-644b1847.js";import"./useZIndex-485d43a8.js";import"./index-c432bd8b.js";import"./ContextIsolator-39488bbe.js";import"./regeneratorRuntime-92fa3873.js";import"./asyncToGenerator-8c72b493.js";import"./PurePanel-3b626b50.js";import"./index-483dddfd.js";import"./index-17cf8f21.js";import"./collapse-97de76d4.js";import"./UnstableContext-61068371.js";import"./add-new-position-section-a22854c0.js";import"./SnippetsOutlined-35689580.js";import"./add-existing-position-section-36d5a370.js";import"./CopyOutlined-a7df096a.js";import"./erf-ja-component-db59bd0d.js";import"./erf-jd-component-e7d6734a.js";import"./erf-update-status-component-0cae6f63.js";import"./erf-record-thunk-d5748df2.js";import"./erf-record-service-b3950ea2.js";import"./index-03f56006.js";import"./CheckCircleFilled-0bc9ae28.js";import"./CloseCircleFilled-8016b598.js";import"./InfoCircleFilled-754e7ccb.js";import"./pickAttrs-120b0d1f.js";import"./CloseOutlined-4e952bfd.js";import"./index-0e3b11af.js";import"./index-bd5286d6.js";import"./fade-3b753323.js";import"./useClosable-8f79493c.js";import"./Skeleton-409b679b.js";import"./useLocale-e161ac43.js";import"./EditOutlined-44724981.js";import"./FileOutlined-3cf87c30.js";import"./FileTextOutlined-ab54bf29.js";import"./DownOutlined-c198d389.js";import"./styleChecker-e74b8545.js";import"./addEventListener-a8c4752a.js";import"./useBreakpoint-f3738828.js";import"./useForceUpdate-1fd08af1.js";import"./responsiveObserver-b31c8f0b.js";import"./useVariants-4feae1d2.js";import"./CheckOutlined-f2177a54.js";import"./index-b5e563db.js";import"./FolderOpenOutlined-3ddb5a40.js";import"./HolderOutlined-ee98ba78.js";import"./index-20ab114f.js";import"./PlusOutlined-4a5ed35b.js";import"./progress-dcb6b527.js";import"./EyeOutlined-8119b4ba.js";function vt(){var w,I;const[C,f]=m.useState(""),[$,g]=m.useState(""),[T,b]=m.useState(!1),[i,y]=m.useState(null),{erf_records:p,filteredData:k}=J(r=>r.erf_records),x=A();console.log("erf_records",p);const _=r=>{if(r.length===0)x(j(p));else{const t=p.filter(o=>r.includes(o.status));x(j(t))}};m.useEffect(()=>{x(j(p))},[p]);const q=r=>{y(r),b(!0)},P=()=>{b(!1),y(null)},S=r=>{const t=new Date().toLocaleString(),o=(i==null?void 0:i.submitted)||t,a=[{title:"Submitted",status:"finish",description:"Request submitted by manager"},{title:"In Review",status:"process",description:"Under review by Site Director/Site Manager"},{title:"Approved",status:"finish",description:"Request approved for posting"}];switch(r){case"Pending":return{current:0,steps:a.map((s,n)=>({...s,status:n===0?"process":"wait",title:n===0?`${s.title} (${o})`:s.title,description:s.description}))};case"In Review":return{current:1,steps:a.map((s,n)=>({...s,status:n<1?"finish":n===1?"process":"wait",title:n===0?`${s.title} (${o})`:n===1?`${s.title} (${t})`:s.title,description:s.description}))};case"Approved":return{current:2,steps:a.map((s,n)=>({...s,status:n<2?"finish":n===2?"process":"wait",title:n===0?`${s.title} (${o})`:n===1?`${s.title} (${t})`:n===2?`${s.title} (${t})`:s.title,description:s.description}))};case"Completed":return{current:3,steps:a.map((s,n)=>({...s,status:"finish",title:n===0?`${s.title} (${o})`:`${s.title} (${t})`,description:s.description}))};case"Declined":return{current:1,steps:a.map((s,n)=>({...s,status:n===0?"finish":n===1?"error":"wait",title:n===0?`${s.title} (${o})`:n===1?`Declined (${t})`:s.title,description:n===1?"Request declined by approver":s.description}))};default:return{current:0,steps:a}}},D=m.useRef(null),v=(r,t,o)=>{t(),f(r[0]),g(o)},E=r=>{r(),f("")},c=r=>({filterDropdown:({setSelectedKeys:t,selectedKeys:o,confirm:a,clearFilters:s,close:n})=>e.jsxs("div",{style:{padding:8},onKeyDown:h=>h.stopPropagation(),children:[e.jsx(V,{ref:D,placeholder:`Search ${r}`,value:o[0],onChange:h=>t(h.target.value?[h.target.value]:[]),onPressEnter:()=>v(o,a,r),style:{marginBottom:8,display:"block"}}),e.jsxs(Q,{children:[e.jsx(u,{type:"primary",onClick:()=>v(o,a,r),icon:e.jsx(R,{}),size:"small",style:{width:90},children:"Search"}),e.jsx(u,{onClick:()=>s&&E(s),size:"small",style:{width:90},children:"Reset"}),e.jsx(u,{type:"link",size:"small",onClick:()=>{a({closeDropdown:!1}),f(o[0]),g(r)},children:"Filter"}),e.jsx(u,{type:"link",size:"small",onClick:()=>{n()},children:"close"})]})]}),filterIcon:t=>e.jsx(R,{style:{color:t?"#1677ff":void 0}}),onFilter:(t,o)=>o[r].toString().toLowerCase().includes(t.toLowerCase()),onFilterDropdownOpenChange:t=>{t&&setTimeout(()=>{var o;return(o=D.current)==null?void 0:o.select()},100)},render:t=>$===r?e.jsx(z,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[C],autoEscape:!0,textToHighlight:t?t.toString():""}):t}),M=[{title:"Ref #",dataIndex:"ref_id",key:"ref_id",render:(r,t)=>e.jsx(u,{type:"link",onClick:()=>q(t),style:{padding:0,height:"auto"},children:r})},{title:"Requesting Manager",dataIndex:"fullname",key:"fullname",...c("fullname"),render:(r,t,o)=>{var a,s;return console.log("record",t),e.jsxs("div",{children:[(a=t.user)==null?void 0:a.employee_fname," ",(s=t.user)==null?void 0:s.employee_lname]},o)}},{title:"Job Title",dataIndex:"jobTitle",key:"position",...c("position")},{title:"Job Type",dataIndex:"jobType",key:"dept",...c("dept")},{title:"Position Status",dataIndex:"positionStatus",key:"eogs",...c("eogs")},{title:"Target Onboarding Date",dataIndex:"dateNeed",key:"contact",...c("contact"),render:r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):""},{title:"Budget/Cost",dataIndex:"budgetCost",key:"eogs",...c("eogs")},{title:"Date Submitted",dataIndex:"submitted",key:"eogs",...c("eogs"),render:r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):""},{title:"Status",dataIndex:"status",key:"status",render:(r,t,o)=>(console.log("record",t),e.jsx(N,{color:t.status=="Approved"?"green":t.status=="Pending"?"orange":t.status=="Declined"?"red":(t.status=="In Review","blue"),children:t.status},o))},{title:"Action",dataIndex:"action",render:(r,t)=>e.jsx(L,{data:t})}];return e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-x-3",children:e.jsx("h2",{className:"text-lg font-medium text-gray-800",children:e.jsx("b",{children:"ERF Records"})})}),e.jsxs("div",{className:"flex flex-1 justify-between",children:[e.jsx(F,{}),e.jsx("div",{className:"mr-8",children:e.jsx(B,{filterData:_})})]})]}),e.jsx(H,{columns:M,dataSource:k,className:"mt-1"}),e.jsx(O,{title:`ERF Details - ${(i==null?void 0:i.ref_id)||""}`,open:T,onCancel:P,footer:null,width:1e3,style:{top:20},children:i&&e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(d,{title:"Request Information",className:"mb-4",children:e.jsxs(l,{column:2,bordered:!0,size:"small",children:[e.jsx(l.Item,{label:"Reference ID:",children:e.jsx("b",{children:i.ref_id})}),e.jsx(l.Item,{label:"Status:",children:e.jsx(N,{color:i.status==="Approved"?"green":i.status==="Pending"?"orange":i.status==="Declined"?"red":(i.status==="In Review","blue"),children:i.status})}),e.jsx(l.Item,{label:"Requesting Manager:",children:e.jsxs("b",{children:[(w=i.user)==null?void 0:w.employee_fname," ",(I=i.user)==null?void 0:I.employee_lname]})}),e.jsx(l.Item,{label:"Date Submitted:",children:e.jsx("b",{children:i.submitted})}),e.jsx(l.Item,{label:"Job Title:",children:e.jsx("b",{children:i.jobTitle})}),e.jsx(l.Item,{label:"Job Type:",children:e.jsx("b",{children:i.jobType})}),e.jsx(l.Item,{label:"Position Status:",children:e.jsx("b",{children:i.positionStatus})}),e.jsx(l.Item,{label:"Date Needed:",children:e.jsx("b",{children:i.dateNeed})}),e.jsx(l.Item,{label:"Budget/Cost:",span:2,children:e.jsx("b",{children:i.budgetCost})}),i.status==="Declined"&&e.jsx(l.Item,{label:"Reason for Decline:",children:e.jsx("b",{children:i.reason})})]})}),i.businessJustification&&e.jsx(d,{title:"Business Justification",className:"mb-4",children:e.jsx("p",{children:i.businessJustification})}),i.qualifications&&e.jsx(d,{title:"Required Qualifications",className:"mb-4",children:e.jsx("p",{children:i.qualifications})}),i.responsibilities&&e.jsx(d,{title:"Key Responsibilities",children:e.jsx("p",{children:i.responsibilities})})]}),e.jsxs("div",{className:"w-80",children:[e.jsx(d,{title:"Request Progress",size:"small",children:e.jsx(U,{direction:"vertical",current:S(i.status).current,items:S(i.status).steps,size:"small"})}),e.jsx(d,{title:"Timeline Summary",size:"small",className:"mt-4",children:e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Requisition created:"}),e.jsx("span",{className:"text-gray-600",children:i.submitted})]}),i.status!=="Pending"&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Status updated:"}),e.jsx("span",{className:"text-gray-600",children:new Date().toLocaleDateString()})]}),i.dateNeed&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Target start date:"}),e.jsx("span",{className:"text-gray-600",children:i.dateNeed})]})]})})]})]})})]})}export{vt as default};
